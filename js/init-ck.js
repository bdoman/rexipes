var isiPhone=navigator.platform.toLowerCase().indexOf("iphone"),isiPad=navigator.platform.toLowerCase().indexOf("ipad"),isiPod=navigator.platform.toLowerCase().indexOf("ipod"),isAndroidPhone=navigator.platform.toLowerCase().indexOf("linux"),checkboxFilter={$filters:null,$reset:null,groups:[],outputArray:[],outputString:"",init:function(){var e=this;e.$filters=$("#Filters");e.$reset=$(".close-btn");e.$container=$(".grid");e.$filters.find("fieldset").each(function(){e.groups.push({$inputs:$(this).find("input"),active:[],tracker:!1})});e.bindHandlers()},bindHandlers:function(){var e=this;e.$filters.on("change",function(){e.parseFilters()});e.$reset.on("click",function(t){e.$filters[0].reset();e.parseFilters()})},parseFilters:function(){var e=this;for(var t=0,n;n=e.groups[t];t++){n.active=[];n.$inputs.each(function(){$(this).is(":checked")&&n.active.push(this.value)});n.active.length&&(n.tracker=0)}e.concatenate()},concatenate:function(){var e=this,t="",n=!1,r=function(){var t=0;for(var n=0,r;r=e.groups[n];n++)r.tracker===!1&&t++;return t<e.groups.length},i=function(){for(var n=0,r;r=e.groups[n];n++){r.active[r.tracker]&&(t+=r.active[r.tracker]);if(n===e.groups.length-1){e.outputArray.push(t);t="";s()}}},s=function(){for(var t=e.groups.length-1;t>-1;t--){var r=e.groups[t];if(r.active[r.tracker+1]){r.tracker++;break}t>0?r.tracker&&(r.tracker=0):n=!0}};e.outputArray=[];do i();while(!n&&r());e.outputString=e.outputArray.join();!e.outputString.length&&(e.outputString="all");e.$container.mixItUp("isLoaded")&&e.$container.mixItUp("filter",e.outputString)}},titleCase=function(e,t){t=t?t:["of","for","and","a"];return e.replace(/(\w)(\w*)/g,function(e,n,r){var i=n.toUpperCase()+(r!=null?r:"");return t.indexOf(i.toLowerCase())<0?i:i.toLowerCase()})},headspaceTags={$commonTags:null,$commonTagClicked:"",$checkboxTarget:null,init:function(){var e=this;e.$commonTags=$("#CommonTags").find("input");$tagContainer=$(".selected-headspaces");e.bindHandlers()},bindHandlers:function(){var e=this;e.$commonTags.on("change",function(){$this=$(this),tag=$this.val(),tag=$.trim(tag);tagTarget=$('.tag[value="'+tag+'"]').parent("span");$this.is(":checked")?e.addCommonTag(tag):e.removeTag(tag,tagTarget)});e.checkEmpty()},checkTags:function(){var e=this,t=$this.val(),t=$.trim(t);t=titleCase(t);if($('input[type=checkbox][value="'+t+'"]').length){$checkboxTarget=$('input[type=checkbox][value="'+t+'"]');if(!$checkboxTarget.is(":checked")){$checkboxTarget.prop("checked",!0);e.addCommonTag(t)}}else $('.tag[value="'+t+'"]').length||e.addCustomTag(t);e.checkEmpty()},addCommonTag:function(e){var t=this;newTag='<span class="headspace-item"><a href="#" class="remove">x</a><input type="text" name="customheadspace[]" class="tag" value="'+e+'" size="'+e.length+' readonly"></span>';$tagContainer.append(newTag);t.checkEmpty()},addCustomTag:function(e){var t=this;newTag='<span class="headspace-item"><a href="#" class="remove">x</a><input type="text" name="customheadspace[]" class="tag" value="'+e+'" size="'+e.length+' readonly"></span>';$tagContainer.append(newTag);t.checkEmpty()},removeTag:function(e,t){var n=this;console.log("initiate remove");if($('input[type=checkbox][value="'+e+'"]').length){$checkboxTarget=$('input[type=checkbox][value="'+e+'"]');console.log("common tag!");$checkboxTarget.is(":checked")&&$checkboxTarget.prop("checked",!1)}t.remove();n.checkEmpty()},checkEmpty:function(){var e=this;$(".tag").length?$(".empty").hide():$(".empty").show()}};$(document).ready(function(){headspaceTags.init();$("#in").on("keypress keydown keyup",function(e){if(e.which==13){e.preventDefault();$this=$(this);$this.val().length>0&&headspaceTags.checkTags();$this.val("");return!1}});$(".add-headspace").on("click",function(e){e.preventDefault();$this=$(this).parents("tr").find("input");$this.val().length>0&&headspaceTags.checkTags();$this.val("")});$("body").on("click",".remove",function(e){e.preventDefault();$this=$(this).parent("span");tag=$this.find("input").val();headspaceTags.removeTag(tag,$this)});checkboxFilter.init();$(".grid").mixItUp({controls:{enable:!1},animation:{easing:"cubic-bezier(0.86, 0, 0.07, 1)",duration:600}});$("body").on("click",".cell-btn",function(e){e.preventDefault();var t=$(e.currentTarget),n=t.closest("tr");switch(t.attr("data-action")){case"add":n.after(n.clone().find("input").val("").end());break;case"delete":n.remove()}var r=$(".step-counter").length;$(".step-counter").each(function(e){r=e+1;$(this).html("Step "+r+":")});return!1});$("body").on("click",".filter-btn",function(){$(".filter-closed").fadeOut("fast").promise().done(function(){$(".filter-open").fadeIn("fast").promise().done(function(){$(".filter-expand").slideDown("fast")})})});$("body").on("click",".close-btn",function(){$(".filter-expand").slideUp("fast").promise().done(function(){$(".filter-open").fadeOut("fast").promise().done(function(){$(".filter-closed").fadeIn("fast")})})});$("#Rexipe").submit(function(e){e.preventDefault();$.ajax({type:"post",url:"/send_form_email.php",data:$(this).serialize(),success:function(){$(":submit").attr("disabled","disabled");$(":submit").val("Rexipe Submitted!");$(":submit").addClass("success")}})})});